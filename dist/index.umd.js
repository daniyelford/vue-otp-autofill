(function(e,c){typeof exports=="object"&&typeof module<"u"?module.exports=c(require("vue")):typeof define=="function"&&define.amd?define(["vue"],c):(e=typeof globalThis<"u"?globalThis:e||self,e.OtpInput=c(e.Vue))})(this,(function(e){"use strict";function c(g){const i=e.ref(""),r=e.ref(""),p=e.ref(null);let a=null,l=null;const d=async()=>{if(!("OTPCredential"in window)||!navigator.credentials?.get){r.value="win:"+("OTPCredential"in window)+",get"+navigator.credentials?.get;return}l&&l.abort(),l=new AbortController;try{const s=await navigator.credentials.get({otp:{transport:["sms"]},signal:l.signal});if(p.value=s,s?.code){const f=String(s.code).match(/\d+/)?.[0]||"";i.value=f,a&&(clearInterval(a),a=null)}}catch(s){s.message&&(r.value=s.message)}},u=()=>{a&&clearInterval(a),i.value||(d(),a=setInterval(()=>{i.value||d()},g))};return e.onUnmounted(()=>{a&&clearInterval(a),l&&l.abort()}),{errorMsg:r,otpR:p,otpResult:i,requestOTP:u}}const y={class:"otp-container"},k=["value","onInput","onKeydown"];return{__name:"OtpInput",props:{modelValue:{type:String,default:""},css:{type:String,default:""},length:{type:Number,default:6},timer:{type:Number,default:16e3},reset:{type:Number,default:0},fakeCode:{type:String,default:"123456"},production:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(g,{emit:i}){const r=g,p=i,a=e.ref(Array.from({length:r.length},(t,n)=>r.modelValue[n]||"")),{errorMsg:l,otpR:d,otpResult:u,requestOTP:s}=c(r.timer),f=t=>{const n={"۰":"0","۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9"};return t.replace(/[۰-۹]/g,o=>n[o])},x=(t,n)=>{const o=f(t.target.value).replace(/[^0-9]/g,"").charAt(0)||"";a.value[n]=o,o&&n<a.value.length-1&&e.nextTick(()=>t.target.parentElement.children[n+1].focus())},w=(t,n)=>{const o=t.currentTarget.parentElement.children;if(t.key==="Backspace"){!a.value[n]&&n>0&&e.nextTick(()=>o[n-1].focus());return}t.key==="ArrowLeft"&&n>0&&e.nextTick(()=>o[n-1].focus()),t.key==="ArrowRight"&&n<a.value.length-1&&e.nextTick(()=>o[n+1].focus())};return e.watch(a,t=>{r.production||console.log(t),p("update:modelValue",t.join(""))},{deep:!0}),e.watch(u,t=>{const n=f(t).split("").slice(0,r.length);e.nextTick(()=>{for(let o=0;o<r.length;o++)a.value[o]=n[o]||""})}),e.watch(r.reset,()=>{e.nextTick(()=>{for(let t=0;t<r.length;t++)a.value[t]="";u.value="",s()})}),e.onMounted(()=>{const t=document.createElement("style");if(t.textContent=r.css&&r.css.trim().length>0?r.css:`
    .hideMassages { display:none; }
    .otp-container { direction: ltr;display: flex; gap: 0.5rem; justify-content: space-evenly; }
    .digit-box { width: 1.5rem; height: 2rem; font-size: 1rem; text-align: center; border: 2px solid black; border-radius: 6px; }
    .bounce { animation: pulse 0.3s ease-in-out alternate; } 
      @keyframes pulse { 0% { transform: scale(1); } 100% { transform: scale(1.1); } }
    `,document.head.appendChild(t),!r.production){const n=navigator.credentials.get?.bind(navigator.credentials);navigator.credentials.get=async o=>o?.otp?{code:String(r.fakeCode)}:n?n(o):null}s()}),(t,n)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(l)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(r.production?"hideMassages":"")},e.toDisplayString(e.unref(l)),3)):e.createCommentVNode("",!0),e.unref(d)?(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(r.production?"hideMassages":"")},e.toDisplayString(e.unref(d)),3)):e.createCommentVNode("",!0),e.createElementVNode("div",y,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.value,(o,m)=>(e.openBlock(),e.createElementBlock("input",{key:m,type:"text",class:e.normalizeClass(["digit-box",{bounce:o!==""}]),value:o,maxlength:"1",onInput:h=>x(h,m),onKeydown:h=>w(h,m)},null,42,k))),128))])],64))}}}));
