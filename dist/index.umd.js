(function(e,i){typeof exports=="object"&&typeof module<"u"?module.exports=i(require("vue")):typeof define=="function"&&define.amd?define(["vue"],i):(e=typeof globalThis<"u"?globalThis:e||self,e.OtpInput=i(e.Vue))})(this,(function(e){"use strict";function i(m){const c=e.ref(""),l=e.ref(""),u=e.ref(null);let n=null,s=null;const g=async()=>{if(!("OTPCredential"in window)||!navigator.credentials?.get){l.value="win:"+("OTPCredential"in window)+",get"+navigator.credentials?.get;return}s&&s.abort(),s=new AbortController;try{const a=await navigator.credentials.get({otp:{transport:["sms"]},signal:s.signal});if(u.value=a,a?.code){const d=String(a.code).match(/\d+/)?.[0]||"";c.value=d,e.nextTick(()=>{const y=document.querySelectorAll(".otp-container input");d.split("").slice(0,m).forEach((k,t)=>{y[t].value=k})}),n&&(clearInterval(n),n=null)}}catch(a){a.message&&(l.value=a.message)}},h=()=>{n&&clearInterval(n),c.value||(n=setInterval(()=>{c.value||g()},19e3))};return e.onUnmounted(()=>{n&&clearInterval(n),s&&s.abort()}),{errorMsg:l,otpR:u,otpResult:c,requestOTP:h}}const w={class:"otp-container"},x=["onUpdate:modelValue","onInput","onKeydown"];return{__name:"OtpInput",props:{modelValue:{type:String,default:""},length:{type:Number,default:6},reset:{type:Number,default:0}},emits:["update:modelValue"],setup(m,{emit:c}){const l=m,u=c,n=e.ref(Array.from({length:l.length},(t,o)=>l.modelValue[o]||"")),{errorMsg:s,otpR:g,otpResult:h,requestOTP:a}=i(l.length),d=t=>{const o={"۰":"0","۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9"};return t.replace(/[۰-۹]/g,r=>o[r])},y=(t,o)=>{const r=d(t.target.value).replace(/[^0-9]/g,"").charAt(0)||"";n.value[o]=r,r&&o<n.value.length-1&&e.nextTick(()=>t.target.parentElement.children[o+1].focus())},k=(t,o)=>{const r=t.currentTarget.parentElement.children;if(t.key==="Backspace"){!n.value[o]&&o>0&&e.nextTick(()=>r[o-1].focus());return}t.key==="ArrowLeft"&&o>0&&e.nextTick(()=>r[o-1].focus()),t.key==="ArrowRight"&&o<n.value.length-1&&e.nextTick(()=>r[o+1].focus())};return e.watch(n,()=>{u("update:modelValue",n.value.join(""))},{deep:!0}),e.watch(g,t=>{console.log(t)}),e.watch(s,t=>{console.log(t)}),e.watch(h,t=>{n.value=d(t).split("").slice(0,l.length),u("update:modelValue",t)}),e.watch(l.reset,()=>{n.value=e.ref(Array.from({length:l.length},(t,o)=>"")),a()}),e.onMounted(()=>{const t=document.createElement("style");t.textContent=`
    .otp-container { direction: ltr;display: flex; gap: 0.5rem; justify-content: space-evenly; }
    .digit-box { width: 1.5rem; height: 2rem; font-size: 1rem; text-align: center; border: 2px solid black; border-radius: 6px; }
    .bounce { animation: pulse 0.3s ease-in-out alternate; } 
      @keyframes pulse { 0% { transform: scale(1); } 100% { transform: scale(1.1); } }
    `,document.head.appendChild(t),a()}),(t,o)=>(e.openBlock(),e.createElementBlock("div",w,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.value,(r,p)=>e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:p,type:"text",class:e.normalizeClass(["digit-box",{bounce:r!==""}]),"onUpdate:modelValue":f=>n.value[p]=f,maxlength:"1",onInput:f=>y(f,p),onKeydown:f=>k(f,p)},null,42,x)),[[e.vModelText,n.value[p]]])),128))]))}}}));
